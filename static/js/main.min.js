// Minified OCR System JavaScript - Optimized for Performance
let e,t,n,i,o,s;document.addEventListener("DOMContentLoaded",(function(){!function(){e=document.getElementById("uploadForm"),t=document.getElementById("file"),n=document.getElementById("imagePreview"),i=document.getElementById("submitBtn"),o=document.getElementById("btnText"),s=document.getElementById("btnSpinner"),console.log("Componentes inicializados correctamente")}(),function(){t&&t.addEventListener("change",l),e&&e.addEventListener("submit",g),t&&function(){const e=t.closest(".card-body");if(!e)return;function n(e){e.preventDefault(),e.stopPropagation()}function i(){e.classList.add("border-primary","bg-light")}function o(){e.classList.remove("border-primary","bg-light")}["dragenter","dragover","dragleave","drop"].forEach((t=>{e.addEventListener(t,n,!1),document.body.addEventListener(t,n,!1)})),["dragenter","dragover"].forEach((t=>{e.addEventListener(t,i,!1)})),["dragleave","drop"].forEach((t=>{e.addEventListener(t,o,!1)})),e.addEventListener("drop",(function(e){const n=e.dataTransfer.files;n.length>0&&(t.files=n,t.dispatchEvent(new Event("change",{bubbles:!0})))}),!1)}(),function(){document.querySelectorAll('a[href^="#"]').forEach((e=>{e.addEventListener("click",(function(e){e.preventDefault();const t=document.querySelector(this.getAttribute("href"));t&&t.scrollIntoView({behavior:"smooth",block:"start"})}))})),setTimeout((()=>{document.querySelectorAll(".alert-dismissible").forEach((e=>{const t=e.querySelector(".btn-close");t&&t.click()}))}),1e4),document.addEventListener("keydown",(function(e){"Tab"===e.key&&document.body.classList.add("keyboard-navigation")})),document.addEventListener("mousedown",(function(){document.body.classList.remove("keyboard-navigation")}))}()}(),function(){const t=e;if(!t)return;t.querySelectorAll("input, select").forEach((e=>{e.addEventListener("blur",y),e.addEventListener("input",v)}))}();const l=[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));l.map((function(e){return new bootstrap.Tooltip(e)}))}));function l(e){const t=e.target.files[0];if(t){if(!["image/png","image/jpeg","image/jpg","image/gif","image/bmp","image/tiff","image/webp"].includes(t.type))return c("Tipo de archivo no válido. Use PNG, JPG, JPEG, GIF, BMP, TIFF o WEBP.","error"),void(t.value="",u());if(t.size>16777216)return c("El archivo es demasiado grande. Máximo 16MB permitido.","error"),void(t.value="",u());a(t),function(e){const t=e.size,n=document.getElementById("profileSuggestion");if(!n)return;let i,o="rapido",s="",l="bg-success";t<512e3?(o="ultra_rapido",s="Imagen pequeña - Perfil Ultra Rápido recomendado",l="bg-primary"):t>2097152?(o="normal",s="Imagen grande - Perfil Normal recomendado para mejor calidad",l="bg-warning"):s="Tamaño óptimo - Perfil Rápido recomendado",n.innerHTML=`\n        <div class="alert alert-info py-2 mb-0">\n            <i class="fas fa-lightbulb me-2"></i>\n            <span class="badge ${l} me-2">${o}</span>\n            ${s}\n        </div>\n    `;const c=document.getElementById("profile");c&&(c.value=o,(i=c).classList.add("border-warning"),setTimeout((()=>{i.classList.remove("border-warning")}),2e3))}(t)}else u()}function a(e){const t=new FileReader;t.onload=function(t){const i=function(e){return{name:e.name,size:function(e){if(0===e)return"0 Bytes";const t=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,n)).toFixed(2))+" "+t[n]}(e.size),type:e.type}}(e);n.innerHTML=`\n            <div class="row align-items-center">\n                <div class="col-md-6 text-center">\n                    <img src="${t.target.result}" alt="Preview" class="img-fluid rounded shadow" style="max-height: 200px;">\n                </div>\n                <div class="col-md-6">\n                    <h6><i class="fas fa-info-circle me-2"></i>Información del Archivo:</h6>\n                    <ul class="list-unstyled small">\n                        <li><strong>Nombre:</strong> ${i.name}</li>\n                        <li><strong>Tamaño:</strong> ${i.size}</li>\n                        <li><strong>Tipo:</strong> ${i.type}</li>\n                        <li><strong>Dimensiones:</strong> <span id="imageDimensions">Calculando...</span></li>\n                    </ul>\n                    <div id="profileSuggestion" class="mt-2"></div>\n                </div>\n            </div>\n        `,n.classList.add("active"),n.style.display="block";const o=new Image;o.onload=function(){document.getElementById("imageDimensions").textContent=`${o.width} x ${o.height} píxeles`},o.src=t.target.result},t.readAsDataURL(e)}function u(){n&&(n.innerHTML="",n.classList.remove("active"),n.style.display="none")}function g(e){return t.files&&0!==t.files.length||(e.preventDefault(),c("Por favor seleccione un archivo antes de continuar.","error"),!1)?(function(){i&&o&&s&&(i.disabled=!0,o.textContent="Procesando...",s.classList.remove("d-none"),function(){const e=document.createElement("div");e.className="loading-overlay",e.innerHTML='\n        <div class="loading-spinner">\n            <div class="spinner-border text-light" role="status">\n                <span class="visually-hidden">Cargando...</span>\n            </div>\n            <div class="mt-3">\n                <h5 class="text-light">Procesando documento...</h5>\n                <p class="text-light">Esto puede tomar unos momentos dependiendo del tamaño y complejidad de la imagen.</p>\n            </div>\n        </div>\n    ',document.body.appendChild(e),setTimeout((()=>{document.body.contains(e)&&document.body.removeChild(e)}),3e4)}())}(),!0):void 0}function y(e){const t=e.target,n=t.value.trim();return f(e),!("file"!==t.type||0!==t.files.length)||(d(t,"Debe seleccionar un archivo"),!1)}function d(e,t){e.classList.add("is-invalid");let n=e.parentNode.querySelector(".invalid-feedback");n||(n=document.createElement("div"),n.className="invalid-feedback",e.parentNode.appendChild(n)),n.textContent=t}function f(e){const t=e.target;t.classList.remove("is-invalid");const n=t.parentNode.querySelector(".invalid-feedback");n&&n.remove()}function c(e,t="info",n=5e3){const i=document.createElement("div");i.className=`alert alert-${"error"===t?"danger":t} alert-dismissible fade show position-fixed`,i.style.cssText="top: 20px; right: 20px; z-index: 9999; min-width: 300px;",i.innerHTML=`\n        <i class="fas fa-${"error"===t?"exclamation-triangle":"success"===t?"check-circle":"info-circle"} me-2"></i>\n        ${e}\n        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>\n    `,document.body.appendChild(i),setTimeout((()=>{document.body.contains(i)&&i.remove()}),n)}window.location.pathname.includes("results")&&function(){!function(){document.querySelectorAll(".card-header").forEach((e=>{"false"!==e.dataset.collapsible&&(e.style.cursor="pointer",e.addEventListener("click",(function(){const e=this.nextElementSibling;e&&e.classList.toggle("show")})))}))}(),function(){document.querySelectorAll(".image-container img").forEach((e=>{e.addEventListener("click",(function(){!function(e,t){const n=document.createElement("div");n.className="modal fade",n.innerHTML=`\n            <div class="modal-dialog modal-lg">\n                <div class="modal-content">\n                    <div class="modal-header">\n                        <h5 class="modal-title">${t||"Imagen"}</h5>\n                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>\n                    </div>\n                    <div class="modal-body text-center">\n                        <img src="${e}" class="img-fluid" alt="${t||"Imagen"}">\n                    </div>\n                </div>\n            </div>\n        `,document.body.appendChild(n);const i=new bootstrap.Modal(n);i.show(),n.addEventListener("hidden.bs.modal",(()=>{document.body.removeChild(n)}))}(this.src,this.alt)}))}))}(),function(){document.querySelectorAll(".copy-text-btn").forEach((e=>{e.addEventListener("click",(function(){const e=this.getAttribute("data-target"),t=document.querySelector(e);if(t){const e=t.textContent||t.innerText;navigator.clipboard?navigator.clipboard.writeText(e).then((()=>{c("Texto copiado al portapapeles","success")})).catch((()=>{c("Error al copiar texto","error")})):c("Funcionalidad de copia no disponible","warning")}}))}))}(),function(){const e=document.getElementById("downloadAll");e&&e.addEventListener("click",(function(){const e=document.querySelectorAll(".download-link");if(0===e.length)return void c("No hay archivos para descargar","warning");e.forEach(((e,t)=>{setTimeout((()=>{const t=document.createElement("a");t.href=e.href,t.download=e.getAttribute("data-filename")||"archivo",t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}),100*t)})),c(`Descargando ${e.length} archivos...`,"info")}))}))}()};